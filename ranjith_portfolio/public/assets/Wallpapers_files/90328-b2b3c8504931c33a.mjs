"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[90328],{178671:(e,t,i)=>{i.r(t),i.d(t,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinBlock_pin",selections:[{args:null,kind:"FragmentSpread",name:"StoryPinStickerBlockCloseup_pin"}],type:"Pin",abstractKey:null};n.hash="8bb1bb1f7bafeed0fe43bed44ef12d2a";let l=n},287261:(e,t,i)=>{i.r(t),i.d(t,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinStickerBlockCloseup_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"236x")'},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxPrice",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};n.hash="7e8d917850c8329247291df0d281a59b";let l=n},907932:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(667294),l=i(883119),o=i(923368),s=i(785893);function r({accessibilityLabel:e,handleClick:t,icon:i,iconColor:r,iconOnly:a,testId:d,buttonText:c,tabIndex:h,bgColor:u,isActive:p}){let[_,g]=(0,n.useState)(!1),m=(0,n.useRef)(null),{setAbortNoActionPlacementTimeout:y}=(0,o.x4)(),x=()=>{g(e=>!e),t(),y(!0)},f=e=>{m&&e.target instanceof Element&&!m.current?.contains(e.target)&&g(!1)};return(0,n.useEffect)(()=>(window.addEventListener("mousedown",f),()=>{window.removeEventListener("mousedown",f)}),[]),(0,n.useEffect)(()=>{void 0!==p&&g(p)},[p]),(0,s.jsx)(l.xu,{"data-test-id":d||"closeup-action-bar-button",children:(0,s.jsxs)(l.kC,{alignItems:"center",justifyContent:"start",children:[(0,s.jsx)(l.hU,{ref:m,accessibilityLabel:e,bgColor:u,icon:i,iconColor:r||"darkGray",onClick:x,selected:_,size:a?"md":"lg",tabIndex:h}),c&&(0,s.jsx)(l.iP,{onTap:x,rounding:2,children:(0,s.jsx)(l.X6,{color:"light",overflow:"normal",size:"400",children:c})})]})})}},836910:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(667294),l=i(883119),o=i(12163),s=i(214877),r=i(140017),a=i(158838),d=i(923368),c=i(785893);class h extends n.PureComponent{constructor(...e){var t,i,n;super(...e),t="startAudiblePlayTime",i=this.props.muted?null:new Date,(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in this?Object.defineProperty(this,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[t]=i}componentDidUpdate(e){e.muted!==this.props.muted&&(this.startAudiblePlayTime=this.props.muted?null:new Date)}componentWillUnmount(){let{musicRecordingId:e,muted:t,pinId:i,video:n}=this.props;if(e&&!t&&this.startAudiblePlayTime&&Date.now()-this.startAudiblePlayTime.getTime()>=2e3){let{hlsv3:t,mp4:l}=(0,a.ZP)({vEXP3:n.video_list?.V_EXP3,vEXP4:n.video_list?.V_EXP4,vEXP5:n.video_list?.V_EXP5,vEXP6:n.video_list?.V_EXP6,vEXP7:n.video_list?.V_EXP7,v720P:n.video_list?.V_720P,vHLSV3MOBILE:n.video_list?.V_HLSV3_MOBILE})||{},o=(l||t)?.duration||0;this.props.logContextEvent({event_type:8999,object_id_str:e,aux_data:{pin_id:i,story_pin_music_duration:o}})}}render(){let{activePageIndex:e,blockHeight:t,blockWidth:i,closeupStoryPinViewability:n,customEndCard:s,isPlaying:r,muted:d,onEnded:h,onUpdateVideoInfo:u,pageIndex:p,pinId:_,roundCorners:g=!0,stackedCloseupEnabled:m,video:y,videoThumbnailStartTime:x}=this.props,{hlsv3:f,mp4:v}=(0,a.ZP)({vEXP3:y.video_list?.V_EXP3,vEXP4:y.video_list?.V_EXP4,vEXP5:y.video_list?.V_EXP5,vEXP6:y.video_list?.V_EXP6,vEXP7:y.video_list?.V_EXP7,v720P:y.video_list?.V_720P,vHLSV3MOBILE:y.video_list?.V_HLSV3_MOBILE})??{},b=v||f;if(!b)return null;let{height:P,thumbnail:w,width:S}=b,j=(S??1)/(P??1),C={height:"100%",left:"0",top:"0",width:"100%"},k=i/t;if(Math.abs(k-j)>.01){if(k<j){let e=100*j/k;C.width=`${e}%`,C.left=`-${(e-100)/2}%`}else if(k>j){let e=100*k/j;C.height=`${e}%`,C.top=`-${(e-100)/2}%`}}let E="number"==typeof e&&p<=e+3;return(0,c.jsx)(l.xu,{height:t,overflow:"hidden",position:"relative",width:i,children:(0,c.jsx)(l.xu,{height:"100%",position:"absolute",width:"100%",children:E||r||x?(0,c.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:C},position:"absolute",children:(0,c.jsx)(o.Z,{autoplay:r,closeupStoryPinViewability:n,contextLogData:{component:0===p?227:228,element:10957,objectId:_,story_pin_page_id:p,view:3,viewParameter:157},customEndCard:s,customThumbnail:w,isPromoted:!1,loop:!1,muted:d,objectFit:v?"cover":void 0,onEnded:()=>{h&&h(p)},onTimeChange:({time:e})=>{u&&"number"==typeof b.duration&&b.duration>0&&u({currentTime:e,duration:b.duration/1e3})},pinId:_,preferMp4:!!v,roundingOverride:g?null:0,showControls:m?"hover":"never",variant:"storyPin",video:{id:y.id,hlsv3:f,mp4:v},videoThumbnailStartTime:x})}):(0,c.jsx)(l.Ee,{alt:this.props.i18n._('Video cover image', 'closeup.storyPin.videoCover', 'cover image displayed for a video'),fit:"cover",naturalHeight:P??1,naturalWidth:S??1,src:w??""})})})}}function u(e){let{logContextEvent:t}=(0,s.v)(),i=(0,r.ZP)(),{stackedCloseupEnabled:n}=(0,d.x4)();return(0,c.jsx)(h,{...e,i18n:i,logContextEvent:t,stackedCloseupEnabled:n})}},990328:(e,t,i)=>{i.d(t,{Z:()=>N}),i(167912);var n,l,o=i(883119),s=i(737684),r=i(616550),a=i(214877),d=i(757640),c=i(771981),h=i(785893);let u=({block:{block_style:{height:e=0,width:t=0,x_coord:i=0,y_coord:n=0,rotation:l=0}={},original_comment_id:u},pageAspectRatio:p,scaleFactor:_})=>{let{logContextEvent:g}=(0,a.v)(),m=s._B/p,y=t*s._B*_/100,x=i*s._B*_/100,f=(0,r.k6)(),{data:v}=(0,d.Z)({name:"AggregatedCommentResource",options:{commentId:u,field_set_key:"comment_reply_sticker"}});return(0,h.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{left:x,top:n*m*_/100,transform:`rotate(${l}deg)`}},display:"flex",height:e*m*_/100,margin:-1,padding:1,position:"absolute",rounding:2,width:y,zIndex:c.B5,children:(0,h.jsx)(o.iP,{onTap:()=>{g({event_type:102,view_type:1,component:227,element:12541,aux_data:{comment_id:u}}),v?.pin_id&&f.push(`/pin/${v.pin_id}/comments/${u||""}`)},rounding:"pill"})})};var p=i(448318),_=i(590107);function g({src:e,fallbackSrc:t,...i}){let n=(0,_.Z)(e);return(0,h.jsx)(p.Z,{...i,src:n?e:t})}var m=i(702664);function y({isUseCache:e,signature:t}){return(0,m.useSelector)(({pinbuilder:i})=>{let{storyPinItemBlocks:n}=i;if(!e)return null;for(let e of Object.keys(n))if(n[e].media?.signatureEdited===t||n[e].media?.signature===t)return n[e];return null})}var x=i(667294),f=i(161881),v=i(406718),b=i(930837),P=i(140017),w=i(413110);let S=({aggregatedCommentId:e,onDismiss:t})=>{let i=(0,P.ZP)(),n=(0,v.Z)(),l=(0,f.Z)(),[s,r]=(0,x.useState)(""),a=(0,h.jsx)(o.kC,{justifyContent:"end",children:(0,h.jsx)(o.zx,{color:"red",disabled:!s,onClick:()=>{(async()=>{await l({fromUnifiedComment:!0,objectType:w.o.aggregatedComment,objectId:e,tags:"[]",text:s})})(),t()},text:i._('Post', 'ideapin.questionsticker.replymodal.postbutton', 'Post reply to creator Q&A question')})});return(0,h.jsx)(b.ZP,{accessibilityModalLabel:"reply to creator Q and A question",align:"start",footer:a,heading:i._('Reply', 'ideapin.questionsticker.replymodal', 'Reply to creator Q&A question'),onDismiss:t,children:(0,h.jsx)(o.xu,{paddingX:8,paddingY:1,children:(0,h.jsx)(o.Kx,{id:"ideaPinQuestionStickerReplyModalTextArea",onChange:({value:e})=>{r(e)},placeholder:n?i._('Your reply will show up as a public comment on this Pin.', 'pin.questionsticker.replymodal.placeholder', 'Placeholder for creator Q&A reply textarea'):i._('Your reply will show up as a public comment on this Idea Pin.', 'ideapin.questionsticker.replymodal.placeholder', 'Placeholder for creator Q&A reply textarea'),value:s})})})};var j=i(205841),C=i(207012),k=i(339001),E=i(340523),A=i(749886),I=i(520718);let T=void 0!==n?n:n=i(287261);function z({block:e,elementType:t,onFlyoutOpen:i,pageAspectRatio:n,pageIndex:l,pinKey:u,scaleFactor:p,tooltipElementType:_,videoPinProgress:g}){let{logContextEvent:m}=(0,a.v)(),[y,f]=(0,x.useState)(!1),[v,b]=(0,x.useState)(!1),w=(0,x.useRef)(null),z=(0,r.k6)(),R=(0,P.ZP)(),F=(0,C.Z)(T,u),{checkExperiment:L}=(0,E.F)(),{block_style:{height:M=0,width:B=0,x_coord:O=0,y_coord:D=0,rotation:V=0}={},end_time:Z,error_message:K,interactive_sticker_type:X=null,is_removed:H,is_valid:G,start_time:U,sticker_data:N,type:$}=e,W=F?.entityId,{board_id:q,question_comment_id:Y}=N||{},{image_small_url:Q,full_name:J,username:ee=""}=e.user??{},et=null,ei=G&&5===X&&!!q,en=G&&7===X&&!!Y,el=(0,d.Z)(q&&ei?{name:"BoardResource",options:{field_set_key:"tagged_board_preview",board_id:q}}:null),{is_collaborative:eo,pin_count:es,url:er}=el.data||{};$===A.h8.PRODUCT_STICKER?et=W?`/pin/${W}/`:"/":$===A.h8.MENTION_STICKER?et=`/${ee}/`:ei&&(et=el.isLoaded?`${er}`:null);let ea=s._B/n,ed=B*s._B*p/100,ec=O*s._B*p/100,{currentTime:eh}=g||{},eu=!(0,I.Z)({currentTime:eh,endTime:Z,startTime:U}),ep=()=>{m({event_type:123,component:228,element:_,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:l}}),f(!1)},e_=({event:e})=>{m({event_type:120,component:228,element:_,view_type:3,view_parameter:157,aux_data:{error_message:!G&&K?K:null,story_pin_page_id:l}}),f(!0),i&&(e.stopPropagation(),i())};(0,x.useEffect)(()=>(document.addEventListener("scroll",()=>{f(!1)}),()=>document.removeEventListener("scroll",()=>{f(!1)})),[]);let eg=()=>[5].includes(X)?G?el.isLoaded?(0,h.jsxs)(x.Fragment,{children:[(0,h.jsxs)(o.xu,{flex:"grow",paddingX:2,children:[(0,h.jsx)(o.xv,{lineClamp:1,size:"100",weight:"bold",children:eo?R._('Explore this group board', 'closeup.StoryPin.stickerBlock.boardSticker.clickLabel', 'Label explaining click action when group board tag flyout showing'):R._('Explore this board', 'closeup.StoryPin.stickerBlock.boardSticker.clickLabel', 'Label explaining click action when board tag flyout showing')}),(0,h.jsx)(o.xv,{size:"100",children:(!!es||0===es)&&(0,k.nk)(R.ngettext('{{ pinCount }} Pin', '{{ pinCount }} Pins', es, 'closeup.StoryPin.stickerBlock.boardSticker.boardLabel', 'Caption when board tag flyout that showing number of Pins on board'),{pinCount:es})})]}),(0,h.jsx)(o.xu,{flex:"none",children:(0,h.jsx)(o.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]}):(0,h.jsxs)(o.xu,{alignItems:"center",direction:"row",display:"flex",flex:"grow",paddingY:2,children:[(0,h.jsx)(o.xu,{marginEnd:1,paddingX:2,children:(0,h.jsx)(o.xv,{color:"subtle",lineClamp:1,size:"100",children:R._('Loading board...', 'closeup.StoryPin.stickerBlock.boardSticker.loadingText', 'Label explaining board sticker still loading')})}),(0,h.jsx)(o.$j,{accessibilityLabel:R._('Board is loading', 'closeup.StoryPin.stickerBlock.boardSticker.loadingSpinnerText', 'Accessibility label for board loading spinner'),show:!0,size:"sm"})]}):(0,h.jsx)(o.xu,{paddingX:2,paddingY:2,children:(0,h.jsx)(o.xv,{color:"subtle",lineClamp:1,size:"200",weight:"bold",children:K})}):(0,h.jsx)(o.xu,{paddingX:2,paddingY:2,children:(0,h.jsx)(o.xv,{color:"subtle",lineClamp:1,size:"200",weight:"bold",children:R._('Sticker not supported yet', 'closeup.StoryPin.stickerBlock.genericStickerError', 'Label explaining this sticker has not been implemented yet')})}),em=()=>{let e=null;switch($){case A.h8.PRODUCT_STICKER:let{gridTitle:t,imageSpec_236x:i,richSummary:n,description:l}=F||{},{displayName:s,products:r}=n||{},a=((r||[])[0]||{}).offerSummary||{},{price:d,maxPrice:c}=a||{},u=!!a&&(!!d||!!c),p=s||t||l;e=(0,h.jsxs)(x.Fragment,{children:[(0,h.jsx)(o.xu,{flex:"none",children:(0,h.jsx)(o.zd,{height:40,rounding:3,wash:!0,width:40,children:(0,h.jsx)(o.Ee,{alt:"",color:"lightGray",fit:"cover",naturalHeight:1,naturalWidth:1,src:i?.url||""})})}),(0,h.jsx)(o.xu,{flex:"grow",paddingX:2,children:u?(0,h.jsxs)(o.kC,{alignContent:"center",alignItems:"stretch",direction:"column",flex:"grow",justifyContent:"center",children:[(0,h.jsx)(o.xv,{color:"shopping",lineClamp:1,size:"100",weight:"bold",children:d}),(0,h.jsx)(o.xv,{lineClamp:1,size:"100",children:p})]}):(0,h.jsx)(o.xv,{lineClamp:1,size:"100",children:p})}),(0,h.jsx)(o.xu,{flex:"none",children:(0,h.jsx)(o.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]});break;case A.h8.MENTION_STICKER:e=(0,h.jsxs)(x.Fragment,{children:[(0,h.jsx)(o.xu,{flex:"none",children:(0,h.jsx)(j.qE,{name:J??"",size:"sm",src:Q??void 0})}),(0,h.jsx)(o.xu,{flex:"grow",paddingX:2,children:(0,h.jsx)(o.xv,{lineClamp:1,size:"200",weight:"bold",children:J})}),(0,h.jsx)(o.xu,{flex:"none",children:(0,h.jsx)(o.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]});break;case A.h8.GENERIC_STICKER:e=eg();break;case A.h8.VTO_MAKEUP_STICKER:e=(0,h.jsx)(o.xv,{size:"300",weight:"bold",children:R._('Try this sticker on your phone!', 'closeup.storyPin.vtoMakeupSticker', 'Caption when @vitural-try-on-makeup tag is tapped for Web')})}return(0,h.jsx)(o.xu,{alignItems:"center","data-test-id":$,display:"flex",justifyContent:"center",padding:$===A.h8.PRODUCT_STICKER?1:3,width:"100%",children:H?(0,h.jsx)(o.xv,{color:"subtle",size:"200",weight:"bold",children:R._('Tag removed!', 'closeup.storyPin.stickerBlock', 'Caption when the tag is removed')}):e})};return(0,h.jsx)(x.Fragment,{children:eu?null:(0,h.jsxs)(o.xu,{ref:w,dangerouslySetInlineStyle:{__style:{left:ec,top:D*ea*p/100,transform:`rotate(${V}deg)`}},"data-test-id":($||"")+"_container",display:"flex",height:M*ea*p/100+2*s.Xw,margin:-1,padding:1,position:"absolute",rounding:2,width:ed+2*s.Xw,zIndex:c.B5,children:[(0,h.jsx)(o.iP,{disabled:eu,onTap:y?ep:({event:e})=>{!eu&&(m({event_type:101,component:228,element:t,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:l}}),en?L("web_question_sticker_display").anyEnabled&&b(!0):e_({event:e}))},rounding:"pill"}),y&&(0,h.jsx)(o.mh,{zIndex:s.tD,children:(0,h.jsx)(o.J2,{_deprecatedShowCaret:!0,anchor:w.current,idealDirection:"up",onDismiss:ep,positionRelativeToAnchor:!1,size:H?"flexible":"sm",children:H?em():(0,h.jsx)(o.iP,{fullWidth:!0,onTap:({event:e})=>{e.preventDefault(),H||(m({event_type:101,component:228,element:_,object_id_str:W,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:l}}),et?z.push(et):ep())},children:em()})})}),!!Y&&v&&(0,h.jsx)(S,{aggregatedCommentId:Y,onDismiss:()=>{b(!1)}})]})})}var R=i(766742),F=i(961936),L=i(626468),M=i(851193);function B({block:e,fontsLoaded:t,pageAspectRatio:i,scaleFactor:n,thumbnail:l}){let{block_style:s,style:r=A.Cc,text:a}=e,{alignment:d,font:c,font_size:u,highlight_color:p,vertical_alignment:_=A.Cc.vertical_alignment}=r,{hex_color:g=A.Cc.hex_color}=r??{},[m,y]=(0,x.useState)(0),[f,v]=(0,x.useState)([]),b=c||A.Cc.font,{name:P,default_size:w,letter_spacing:S,line_height:j}=b,C=(0,M.Z)(b),k=Math.round(100*(s?.width||100))/1e4,E=Math.round(100*(s?.height||100))/1e4,I=Math.round(100*(s?.x_coord||0))/1e4,T=Math.round(100*(s?.y_coord||0))/1e4;(0,x.useEffect)(()=>{if(t){let e=(0,L.KV)({text:a,boxHeight:F.U*E,boxWidth:F.q8*k,font:C,startFontSize:Math.floor(u||w||24)});v(e.lines),y(e.fontSize)}},[t,a]);let z=m*n,B=p?(0,A.pE)(z,j):{x:0,y:0},O=k*F.q8*n+2*B.x,D=E*F.U*n+2*B.y,V=I*F.q8*n-B.x,Z=l?`${100*T}%`:T*(F.q8/i)*n-B.y;return(0,h.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{left:V,top:Z}},display:"flex",height:D,position:"absolute",width:O,children:(0,h.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:(0,R.RK)({alignment:d,verticalAlignment:_})},children:(0,h.jsx)(o.xu,{display:"inlineBlock",maxWidth:"100%",children:(0,h.jsx)("p",{style:(0,R.BN)({fontSize:z,hexColor:g,letterSpacing:S,lineHeight:j,name:P}),children:f.map((e,t)=>(0,h.jsx)("span",{style:(0,R.xm)({fontSize:z,hasText:e.text.length>0,highlightColor:p||null,lineHeight:j}),children:t===f.length-1?e.text:(0,h.jsxs)(x.Fragment,{children:[e.text," ",(0,h.jsx)("br",{})]})},`paragraphLine-${t}-${(a??"").substr(0,9)}`))})})})})}var O=i(836910),D=i(149722);function V({ownerId:e}){let t=(0,P.ZP)(),i=(0,D.Z)(),n=i.isAuth&&i.id===e;return(0,h.jsxs)(o.xu,{alignItems:"center",color:"tertiary",direction:"column",display:"flex",height:"100%",justifyContent:"center",width:"100%",children:[(0,h.jsx)(o.xv,{color:"inverse",children:n?t._('Your video is processing!', 'closeup.storyPin.videoPlaceholder', 'Let user know that their video is still processing'):t._('This video is still processing!', 'closeup.storyPin.videoPlaceholder', 'Let user know that this video is still processing')}),(0,h.jsx)(o.xv,{color:"inverse",children:t._('Check back in a few minutes.', 'closeup.storyPin.videoPlaceholder', 'Let user know to come back in a couple of minutes to view the video')})]})}var Z=i(906623),K=i(570529),X=i(667665);function H({block:e,isActive:t,pwtTrackImageLoad:i,thumbnail:n}){let l=(0,P.ZP)(),o=e.image?.images?.["750x"]||e.image?.images?.["474x"],s=y({isUseCache:!0,signature:e.image_signature});if(!o&&!s)return null;let r=n?"cover":"none";return s?(0,h.jsx)(g,{alt:l._('Story pin image', 'closeup.storypin.renderer', 'Alt text for story pin image'),fallbackSrc:s.media?.src??"",fit:r,isActive:t,naturalHeight:o?.height??1,naturalWidth:o?.width??1,onLoad:i,src:o?.url??""}):(0,h.jsx)(p.Z,{alt:l._('Story pin image', 'closeup.storypin.renderer', 'Alt text for story pin image'),fit:r,isActive:t,naturalHeight:o?.height??1,naturalWidth:o?.width??1,onLoad:i,src:o?.url??""})}function G({activePageIndex:e,block:t,closeupStoryPinViewability:i,customEndCard:n,isActive:l,isSplitLayout:r=!1,musicRecordingId:a,muted:d,onEnded:c,onUpdateVideoInfo:u,ownerId:p,pageAspectRatio:_,pageDimensions:g,pageIndex:m,pinId:x,scaleFactor:f,stillLoading:v,videoThumbnailStartTime:b,thumbnail:P=!1}){let{block_style:{height:w=100,width:S=100,x_coord:j=0,y_coord:C=0}={},video:k}=t,E=s._B/_,{height:A,width:I}=g,T=S*s._B*f/100,z=w*E*f/100,R=(w<100?Math.min(Math.max(100,w)-Math.abs(C),w):Math.min(Math.max(w-Math.abs(C),0),100))*E*f/100,F=(S<100?Math.min(Math.max(100,S)-Math.abs(j),S):Math.min(Math.max(S-Math.abs(j),0),100))*s._B*f/100,L=Math.max(C,0)*E*f/100,M=Math.max(j,0)*s._B*f/100,B=y({isUseCache:!k,signature:t.video_signature});if(v)return null;let{media:D}=B||{},{duration:Z,src:K}=D||{},X=!!K&&!!Z;return k||X?!!(k?.video_list?.V_HLSV3_MOBILE||k?.video_list?.V_720P||X)&&(0,h.jsx)(o.xu,{height:r?"50%":"100%",overflow:"hidden",position:"relative",children:(0,h.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{left:M,top:L}},height:P?A:R,overflow:"hidden",position:"absolute",width:P?I:F,children:(0,h.jsx)(O.Z,{activePageIndex:e,blockHeight:P?A:z,blockWidth:P?I:T,closeupStoryPinViewability:i,customEndCard:n,isPlaying:l,musicRecordingId:a,muted:d,onEnded:c,onUpdateVideoInfo:u,pageIndex:m,pinId:x,roundCorners:z>=A&&T>=I,video:k||{video_list:{V_EXP7:{duration:Z?1e3*Z:0,url:K}}},videoThumbnailStartTime:b})})}):(0,h.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{left:M,top:L}},height:R,position:"absolute",width:F,children:(0,h.jsx)(V,{ownerId:p})})}let U=void 0!==l?l:l=i(178671);function N({activePageIndex:e,block:t,closeupStoryPinViewability:i,customEndCard:n,disableProductStickers:l,fontsLoaded:r,isActive:a,isSplitLayout:d=!1,musicRecordingId:c,muteVideos:p,onEnded:_,onFlyoutOpen:g,onUpdateVideoInfo:m,ownerId:y,pageAspectRatio:x,pageHeight:f,pageIndex:v,pageWidth:b,pinId:P,previewOnly:w,pinKey:S,stillLoading:j=!1,thumbnail:k=!1,transform:E,videoPinProgress:I,videoThumbnailStartTime:T}){let R=(0,C.Z)(U,S),{block_style:{height:F=100,width:L=100,x_coord:M=0,y_coord:O=0}={},interactive_sticker_type:D=null}=t,V=(0,K.g)(),N=(0,Z.E)();if(0===F||0===L)return null;let $=b/s._B;switch(t.type){case A.h8.PARAGRAPH:case A.h8.HEADING:return(0,h.jsx)(B,{block:t,fontsLoaded:r,pageAspectRatio:x,scaleFactor:$,thumbnail:k});case A.h8.VIDEO:return(0,h.jsx)(G,{activePageIndex:e,block:t,closeupStoryPinViewability:i,customEndCard:n,isActive:a,isSplitLayout:d,musicRecordingId:c,muted:p,onEnded:_,onUpdateVideoInfo:m,ownerId:y,pageAspectRatio:x,pageDimensions:{height:f,width:b},pageIndex:v,pinId:P,scaleFactor:$,stillLoading:j,thumbnail:k,videoThumbnailStartTime:T});case A.h8.IMAGE:let{scaleX:W=1,scaleY:q=1}=E||{};return(0,h.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{height:`${F}%`,left:`${M*W}%`,top:`${O*q}%`,width:`${L}%`}},overflow:"hidden",position:"absolute",children:(0,h.jsx)(H,{block:t,isActive:a,pwtTrackImageLoad:()=>{V&&a&&(V.addBinaryAnnotation("pin.id",P,"STRING"),V.addBinaryAnnotation("video",!1,"BOOL"),V.stop()),N&&a&&(N.addBinaryAnnotation("pin.id",P,"STRING"),N.addBinaryAnnotation("video",!1,"BOOL"),N.removeConstraint(X._z),N.markConstraintComplete(X.pM))},thumbnail:k})});case A.h8.MENTION_STICKER:return!w&&(0,h.jsx)(z,{block:{...t},elementType:12120,onFlyoutOpen:g,pageAspectRatio:x,pageIndex:v,pinKey:null,scaleFactor:$,tooltipElementType:12121,videoPinProgress:I});case A.h8.GENERIC_STICKER:return!w&&(e=>{let t=5===D;return(0,h.jsx)(z,{block:{...e},elementType:t?12827:12858,onFlyoutOpen:g,pageAspectRatio:x,pageIndex:v,pinKey:null,scaleFactor:$,tooltipElementType:t?12828:12859,videoPinProgress:I})})(t);case A.h8.PRODUCT_STICKER:return!w&&!l&&(0,h.jsx)(z,{block:{...t},elementType:12223,onFlyoutOpen:g,pageAspectRatio:x,pageIndex:v,pinKey:R,scaleFactor:$,tooltipElementType:12224,videoPinProgress:I});case A.h8.VTO_MAKEUP_STICKER:return!w&&(0,h.jsx)(z,{block:{...t},elementType:12561,onFlyoutOpen:g,pageAspectRatio:x,pageIndex:v,pinKey:null,scaleFactor:$,tooltipElementType:12561,videoPinProgress:I});case A.h8.COMMENT_REPLY_STICKER:return t.type===A.h8.COMMENT_REPLY_STICKER&&!w&&(0,h.jsx)(u,{block:t,pageAspectRatio:x,scaleFactor:$});default:return null}}},737684:(e,t,i)=>{i.d(t,{Xw:()=>a,_B:()=>r,aW:()=>c,ff:()=>s,tD:()=>d,te:()=>l});var n=i(883119);let l={boxShadow:"0 1px 20px 0 rgba(0, 0, 0, 0.1)",borderRadius:32},o=e=>e.length>33?"...":"",s=e=>`${e.substring(0,33)}${o(e)}`,r=375,a=4,d=new n.Ry(3),c=new Set(["related_modules_header","related_products_feed_header"])},475795:(e,t,i)=>{i.r(t),i.d(t,{default:()=>a});var n=i(883119),l=i(907932),o=i(140017),s=i(973868),r=i(785893);function a({controllerOptions:e,iconColor:t,iconOnly:i,buttonText:a,tabIndex:d=0,stackedCloseupEnabled:c=!1}){let h=(0,o.ZP)(),u=new n.Ry(5);return(0,r.jsx)(s.Z,{...e,children:({handleSendShareFlyoutButtonClick:e})=>(0,r.jsx)(n.u,{inline:!0,text:h._('Share', 'Closeup.SharePin.Icon', 'Icon for sharing the current pin'),zIndex:u,children:(0,r.jsx)(l.Z,{accessibilityLabel:h._('Send', 'Accessible label for button to send this pin', 'Accessible label for button to send this pin'),bgColor:c?"white":void 0,buttonText:a,handleClick:()=>e(),icon:"share",iconColor:t,iconOnly:i,tabIndex:d,testId:"closeup-share-button"})})})}},12163:(e,t,i)=>{i.d(t,{Z:()=>D});var n=i(667294),l=i(883119),o=i(475795),s=i(214877),r=i(515278),a=i(140017),d=i(953565),c=i(785893);function h(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let u={__style:{backgroundColor:"#000"}};class p extends n.PureComponent{constructor(...e){super(...e),h(this,"handleRestartVideo",({event:e})=>{e.stopPropagation(),this.props.onRestartVideo?.({event:e}),(0,d.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"restart",variant:"enabled_send_first"}})}),h(this,"handleShareVideo",()=>{let{onToggleFlyout:e,isFlyoutOpen:t,pinId:i,requireAuth:n,logContextEvent:l}=this.props;if(t&&(0,d.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"shareSheetOpen",variant:"enabled_send_first"}}),l({event_type:101,component:179,object_id_str:i,view_type:3,view_parameter:156,element:11731}),n){n();return}e&&e()}),h(this,"handleExternalSend",()=>{(0,d.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"shareSheetOpen",variant:"enabled_send_first"}})}),h(this,"renderReplayButton",()=>(0,c.jsx)(l.iP,{accessibilityLabel:this.props.i18n._('Watch again', 'Button when pressed restarts the video', 'Button when pressed restarts the video'),onTap:this.handleRestartVideo,rounding:2,children:(0,c.jsxs)(l.xu,{alignItems:"center",display:"flex",padding:2,children:[(0,c.jsx)(l.xu,{marginEnd:3,children:(0,c.jsx)(l.JO,{accessibilityLabel:this.props.i18n._('Watch again', 'Button when pressed restarts the video', 'Button when pressed restarts the video'),color:"inverse",icon:"refresh",size:18})}),(0,c.jsx)(l.X6,{color:"light",overflow:"normal",size:"400",children:this.props.i18n._('Watch again', 'Clickable label when pressed restarts the video', 'Clickable label when pressed restarts the video')})]})})),h(this,"renderShareButton",()=>{let{gridDescription:e,imageSrc:t,isFlyoutOpen:i,onFlyoutDismiss:n,pinId:s}=this.props;return(0,c.jsx)(l.iP,{accessibilityLabel:this.props.i18n._('Send', 'end.video.send.icon.label', 'Clickable label when pressed opens share sheet after video is finished'),onTap:this.handleShareVideo,rounding:2,children:(0,c.jsxs)(l.xu,{alignItems:"center",display:"flex",justifyContent:"center",padding:2,children:[(0,c.jsx)(o.default,{controllerOptions:{flyoutDisplayOptions:{shownWithinMasonry:!0},loggingOptions:{component:179,element:72,onExternalSend:this.handleExternalSend,viewType:3},isFlyoutOpen:i,onFlyoutDismiss:n,onToggleFlyout:()=>{},sendObject:{type:"pin",description:e,id:s,imageUrl:t,url:`/pin/${s}/`}},iconColor:"white",iconOnly:!0,tabIndex:-1}),(0,c.jsx)(l.xu,{children:(0,c.jsx)(l.X6,{color:"light",overflow:"normal",size:"400",children:this.props.i18n._('Send', 'end.video.send.icon.label', 'Clickable label when pressed opens share sheet after video is finished')})})]})})})}componentDidMount(){let{pinId:e,logContextEvent:t}=this.props;(0,d.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"land",variant:"enabled_send_first"}}),t({event_type:13,component:179,object_id_str:e,view_type:3,view_parameter:156,element:11731})}render(){let{backgroundImage:e,naturalHeight:t,naturalWidth:i,pinTitle:n}=this.props;return(0,c.jsx)(l.xu,{children:(0,c.jsxs)(l.Ee,{alt:n||"",naturalHeight:t,naturalWidth:i,src:e,children:[(0,c.jsx)(l.xu,{bottom:!0,dangerouslySetInlineStyle:u,left:!0,position:"absolute",right:!0,top:!0}),(0,c.jsx)(l.xu,{alignItems:"center",direction:"column",display:"flex",height:"100%",justifyContent:"center",left:!0,position:"absolute",top:!0,width:"100%",children:(0,c.jsxs)(l.xu,{position:"absolute",children:[(0,c.jsx)(l.xu,{children:this.renderShareButton()}),(0,c.jsx)(l.xu,{alignSelf:"center",children:this.renderReplayButton()})]})})]})})}}function _(e){let{logContextEvent:t}=(0,s.v)(),i=(0,a.ZP)(),n=(0,r.Z)();return(0,c.jsx)(p,{...e,i18n:i,logContextEvent:t,requireAuth:n})}let g=({backgroundImage:e,naturalHeight:t,naturalWidth:i,onRestartVideo:n,pinTitle:o})=>{let s=(0,a.ZP)();return(0,c.jsx)(l.xu,{children:(0,c.jsxs)(l.Ee,{alt:o||"",naturalHeight:t,naturalWidth:i,src:e,children:[(0,c.jsx)(l.xu,{bottom:!0,dangerouslySetInlineStyle:u,left:!0,opacity:.8,position:"absolute",right:!0,top:!0}),(0,c.jsx)(l.xu,{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",left:!0,position:"absolute",top:!0,width:"100%",children:(0,c.jsx)(l.xu,{children:(0,c.jsx)(l.iP,{onTap:n,rounding:2,children:(0,c.jsxs)(l.xu,{alignItems:"center",display:"flex",padding:2,children:[(0,c.jsx)(l.hU,{accessibilityLabel:s._('Replay', 'closeupVideo.endCard.ReplayButton', 'Button when pressed restarts the video'),icon:"refresh",iconColor:"white",size:"md"}),(0,c.jsx)(l.X6,{color:"light",overflow:"normal",size:"400",children:s._('Replay', 'closeupVideo.endCard.ReplayButton', 'Button when pressed restarts the video')})]})})})})]})})};var m=i(86785),y=i(340523),x=i(551587),f=i(906623),v=i(570529),b=i(970126),P=i(5859),w=i(910711),S=i(983435),j=i(749886),C=i(214164),k=i(623891),E=i(554786),A=i(115557),I=i(239821),T=i(923368),z=i(667665),R=i(181056),F=i(718561);function L(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let M=e=>!!e&&e.endsWith(".gif"),B=(e,t)=>{t({currentTime:e?.currentTime??0,duration:e?.duration??1})};class O extends n.Component{constructor(...e){super(...e),L(this,"state",{controls:"always"===this.props.showControls&&!this.props.disabled,fullscreen:!1,playing:!(0,m.G6)(this.props.requestContext.userAgent.browserName)&&!!this.props.autoplay&&!this.props.disabled,ready:!1,seeking:!1,showEndCard:!1,volume:this.props.muted||this.props.shouldMute?0:1,videoStartTime:this.props.videoStartTime||0}),L(this,"setVideoPwtLoadingStop",(e=!1)=>{if(!b.Z)return;let{storyPinStepStopwatch:t,pinId:i,pwtSurfaceContext:n}=this.props;t&&(e||t.addAnnotation("video.startup.end"),t.addBinaryAnnotation("pin.id",i,"STRING"),t.addBinaryAnnotation("video",!0,"BOOL"),t.addBinaryAnnotation("preload",e,"BOOL"),t.addSubspan({name:"perceived_video_load",endTime:b.Z.now()}),t.stop()),n&&(e||n.addAnnotation("video.startup.end"),n.addBinaryAnnotation("pin.id",i,"STRING"),n.addBinaryAnnotation("video",!0,"BOOL"),n.markConstraintComplete(z._z),n.addSubspan("perceived_video_load",null,b.Z.now()),"story_pin"===n.getMetricId().segment&&n.removeConstraint(z.pM))}),L(this,"componentDidMount",()=>{let{customThumbnail:e,video:t,preferMp4:i}=this.props,{mp4:n}=t,l=t.hlsv3||t.hls||null,{thumbnail:o}=i&&n||l||{},s=(0,R.j4)(e||o);s?.ready===4&&(this.setState({ready:!0}),this.props.autoplay&&this.setVideoPwtLoadingStop(!0))}),L(this,"componentDidUpdate",(e,t)=>{this.props.videoStartTime&&this.props.videoStartTime!==e.videoStartTime&&this.setState({videoStartTime:this.props.videoStartTime}),!1===e.isPlaying&&this.props.isPlaying&&this.setState({playing:!0,controls:"never"!==this.props.showControls}),e.isPlaying&&!1===this.props.isPlaying&&this.setState({playing:!1}),e.autoplay!==this.props.autoplay&&(this.setState({playing:!!this.props.autoplay}),this.props.autoplay&&this.state.ready&&this.setVideoPwtLoadingStop(!0)),e.muted!==this.props.muted&&this.setState({volume:this.props.muted?0:1}),"never"===this.props.showControls&&t.controls&&this.setState({controls:!1}),(t.controls||t.playing)&&this.props.disabled&&this.setState({playing:!1,controls:!1}),!t.playing&&this.state.playing&&this.props.onPlay&&this.props.onPlay()}),L(this,"handleTouch",()=>{let{seeking:e}=this.state,{disabled:t}=this.props;e||t||this.setState(e=>({playing:!e.playing}))}),L(this,"handleShowControls",()=>this.setState({controls:!0})),L(this,"handleHideControls",()=>this.setState({controls:!1})),L(this,"handleReady",()=>{let{ready:e,playing:t}=this.state,{autoplay:i,disabled:n}=this.props;i&&!e&&this.setVideoPwtLoadingStop(),this.setState({ready:!0}),(0,m.G6)(this.props.requestContext.userAgent.browserName)&&!t&&i&&!n&&this.setState({playing:!0})}),L(this,"handleEnded",({event:e})=>{let{customThumbnail:t,customEndCard:i,pinId:n,setCurrentVideo:l,loop:o,onEnded:s}=this.props;e.stopPropagation(),!o&&(this.setState({playing:!1}),M(t)||i||(this.setState({showEndCard:!0,videoStartTime:0}),l({pinId:n,isPromoted:!1,currentTime:0})),this.state.fullscreen&&this.exitFullscreen()),s&&s()}),L(this,"handlePause",({event:e})=>{e.stopPropagation(),this.setState({playing:!1})}),L(this,"handlePlay",({event:e})=>{e.stopPropagation(),this.setState({playing:!0})}),L(this,"handleFullscreenChange",({event:e,fullscreen:t})=>{e.stopPropagation(),this.setState({fullscreen:t})}),L(this,"handlePlayheadDown",()=>{this.setState({seeking:!0})}),L(this,"handlePlayheadUp",()=>{setTimeout(()=>{this.setState({seeking:!1})},500)}),L(this,"handleRestartVideo",({event:e})=>{e.stopPropagation(),this.setState({playing:!0,showEndCard:!1})}),L(this,"handleShareRestartVideo",({event:e})=>{e.stopPropagation(),this.setState({playing:!0,showEndCard:!1})}),L(this,"handleVolumeChange",({event:e,volume:t})=>{let{shouldMute:i}=this.props;e.stopPropagation(),i||this.setState({volume:t})}),L(this,"exitFullscreen",()=>{let{document:e}=window;(e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement)&&(e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen())}),L(this,"requestFullscreen",()=>{let{customThumbnail:e,video:t,preferMp4:i}=this.props,{mp4:n}=t,l=t.hlsv3||t.hls||null,{thumbnail:o}=i&&n||l||{},s=(0,R.j4)(e||o);s.requestFullscreen?s.requestFullscreen():s.webkitRequestFullscreen?s.webkitRequestFullscreen():s.mozRequestFullScreen?s.mozRequestFullScreen():s.msRequestFullscreen&&s.msRequestFullscreen()}),L(this,"renderCloseupVideoEndCard",(e,t,i,n)=>{let l={backgroundImage:e,naturalHeight:t,naturalWidth:i,onRestartVideo:this.handleShareRestartVideo},o={backgroundImage:e,naturalHeight:t,naturalWidth:i,onRestartVideo:this.handleRestartVideo},{flyoutShareProps:s}=this.props,r={gridDescription:s?s.gridDescription:"",imageSrc:s?s.imageSrc:"",isFlyoutOpen:!!s&&s.isFlyoutOpen,onFlyoutDismiss:s?s.onFlyoutDismiss:()=>{},onToggleFlyout:s?s.onToggleFlyout:()=>{},pinId:s?s.pinId:""};return n?(0,c.jsx)(g,{...o}):(0,c.jsx)(_,{...r,...l})})}render(){let e;let{autoplay:t,closeupStoryPinViewability:i,contextLogData:n={component:179,is_closeup_video:!0,objectId:this.props.pinId,view:3,viewParameter:156},customThumbnail:o,isPromoted:s,loop:r,objectFit:a,preferMp4:d,preload:h,requestContext:u,roundingOverride:p,showControls:_,variant:g,video:y,captions:f,isDesktop:v,videoThumbnailStartTime:b,pinId:P,setProgressInfo:C,progressInfo:k,setPanelOpen:E,panelOpen:I,setMute:T,isMuted:z,captionsExpGroup:L,stackedCloseupEnabled:M,onTimeChange:O,startLevelHlsExpGroup:D}=this.props;n.is_closeup_video=!0;let{controls:V,fullscreen:Z,playing:K,showEndCard:X,volume:H,videoStartTime:G}=this.state,U=y.hlsv3||y.hls||null;if(!U&&!y.mp4)return null;let{mp4:N}=y,$=d&&N&&N.url||U&&[{type:"video/m3u8",src:U.url}]||void 0,{height:W,thumbnail:q,width:Y}=d&&N||U||{},Q=o||q;e=null!=p?p:"default"===g?0:"storyPin"===g?j.yR:2;let J=M?"100%":"calc(100% - 4px)";return(0,c.jsxs)(l.zd,{rounding:M?void 0:e,wash:!0,willChangeTransform:!((0,m.G6)(u.userAgent.browserName)&&Z),children:[X?this.renderCloseupVideoEndCard(Q??"",W??1,Y??1,s):(0,c.jsxs)(l.iP,{accessibilityLabel:this.props.i18n._('Pause or play video', 'pin.closeup.video.tap', 'tap area to pause or play video'),onMouseEnter:"hover"===_?this.handleShowControls:void 0,onMouseLeave:"hover"===_?this.handleHideControls:void 0,onTap:this.handleTouch,rounding:2,children:[L&&(0,x.Z)(L)||M&&(0,c.jsx)(w.Z,{playing:K,zIndexValue:99}),(0,c.jsx)(F.ZP,{aspectRatio:(Y??1)/(W??1),captions:f&&(0,x.Z)(L||"")||"storyPin"===g?f:"",closeupStoryPinViewability:i,contextLogData:{...n,video_id:this.props.video.id},controls:!(L&&(0,x.Z)(L))&&!M&&V,hlsConfig:{startLevel:D?-1:R.VS},isAutoPlay:!!t,loop:r,objectFit:a,onControlsPause:this.handlePause,onControlsPlay:this.handlePlay,onEnded:this.handleEnded,onFullscreenChange:this.handleFullscreenChange,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:this.handlePlayheadDown,onPlayheadUp:this.handlePlayheadUp,onReady:this.handleReady,onTimeChange:"storyPin"!==g||M?({time:e})=>{B&&"number"==typeof N?.duration&&N.duration>0&&C&&B({currentTime:e,duration:N.duration/A.gJ},C)}:O,onVolumeChange:this.handleVolumeChange,playing:K,poster:Q,preferMp4:d,preload:h,src:$,videoStartTime:G||b,volume:H})]}),(0,c.jsx)(l.xu,{onMouseEnter:"hover"===_?this.handleShowControls:void 0,onMouseLeave:"hover"===_?this.handleHideControls:void 0,children:("storyPin"!==g&&L&&(0,x.Z)(L)||M)&&(0,c.jsx)(l.xu,{bottom:!0,dangerouslySetInlineStyle:{__style:{...R.Ul,flexDirection:"column-reverse"}},display:"flex",height:R.hy,paddingX:6,position:"absolute",width:J,zIndex:j.Gf,children:(0,c.jsx)(S.Z,{activePageIndex:0,captionsExpGroup:L,captionsUrl:f,handleMute:()=>{this.setState({volume:z?1:0}),T(!z)},handlePanelChange:()=>{E&&E(!I),I&&v&&this.requestFullscreen()},handlePause:()=>{this.setState({playing:!1})},handlePausePlay:()=>{this.setState({playing:!K})},handlePlay:()=>{this.setState({playing:!0})},handleWatchAgain:this.handleRestartVideo,isMuted:z,isPanelOpen:I,isPlaying:K,isStoryPin:!1,pageCount:1,pages:[],pinId:P,progressInfo:k,showEndCard:X,showVideoControls:V,viewParameter:156})})})]})}}function D(e){let t=(0,a.ZP)(),i=(0,P.B)(),{isAuthenticated:l}=i,o=(0,v.g)(),s=(0,f.E)(),{seekTime:r}=(0,C.Hx)(),{stackedCloseupEnabled:d}=(0,T.x4)(),{pinId:h,isPromoted:u,video:p,muted:_,variant:g}=e,{appUI:m,setCurrentVideo:x}=(0,I.I)(),{videosAutoplaying:b}=m,{organicVideosAutoplaying:w,promotedVideosAutoplaying:S}=b,j=i.locale.toLowerCase(),A=(p.mp4?.captions_urls||p.hlsv3?.captions_urls)??{},z=j&&A[j]||Object.values(A)[0]||"",{checkExperiment:R}=(0,y.F)(),F=(0,E.HG)(),L="storyPin"!==g&&z&&F&&l?R("auth_desktop_video_pin_captions").group:"",M=R("web_hls_start_up_level").anyEnabled,B=u?S[h]:w[h],D=parseInt((0,k.Z)().t||0,10),[V,Z]=(0,n.useState)(B?.currentTime||0),[K,X]=(0,n.useState)(null),[H,G]=(0,n.useState)(!0),[U,N]=(0,n.useState)(_);return(0,n.useEffect)(()=>{let e=V;D>0&&(e=D),r&&(e=r),Z(e)},[r,D,V]),(0,c.jsx)(O,{...e,captions:String(z)||"",captionsExpGroup:L,i18n:t,isDesktop:F,isMuted:U,isPlaying:!B||!B.paused,panelOpen:H,progressInfo:K,pwtSurfaceContext:s,requestContext:i,setCurrentVideo:x,setMute:N,setPanelOpen:G,setProgressInfo:X,stackedCloseupEnabled:d,startLevelHlsExpGroup:M,storyPinStepStopwatch:o,videoStartTime:V})}L(O,"defaultProps",{loop:!1,showControls:"hover"})},911344:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(537347),l=i.n(n),o=i(953565);function s(e){if("undefined"==typeof window||!document.head)return(0,o.nP)("load_fonts.failure",{sampleRate:1,tags:{failure_reason:"window undefined"}}),Promise.reject(Error("Window is undefined or no head on the document. Unable to load fonts"));let{head:t}=document,i=[];return e.forEach(e=>{e.styles.forEach(n=>{let o=document.querySelector(`#${e.fontFamily??""}-${n.name}`);o||((o=document.createElement("style")).setAttribute("id",`${e.fontFamily??""}-${n.name}`),t.appendChild(o),e.format&&n.fontUrl&&o&&o.sheet&&o.sheet.insertRule(`
            @font-face {
              font-family: "${e.fontFamily??""}";
              font-style: "${n.fontStyle}";
              font-weight: "${n.fontWeight}";
              src: url("${n.fontUrl}") format("${e.format}");
            }
          `,0),i.push(new(l())(e.fontFamily,{style:n.fontStyle,weight:n.fontWeight}).load()))})}),Promise.all(i).then(()=>{Promise.resolve()}).catch(e=>{(0,o.nP)("load_fonts.failure",{sampleRate:1,tags:{failure_reason:"unsuccessful load"}}),Promise.reject(e)})}},448318:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(667294),l=i(262032),o=i(785893);let s=e=>document.querySelector(`img[src="${e}"]`)||null,r=(e,t,i)=>{let l=(0,n.useRef)(null),o=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(e!==l.current||i&&i!==o.current){l.current=e;let i=s(e);i?.complete&&t()}o.current=i},[e,t,i])};function a({alt:e,children:t,color:i,elementTiming:n,isActive:s=!1,naturalHeight:a,naturalWidth:d,onLoad:c,src:h,fit:u="none"}){return r(h,c,s),(0,o.jsx)(l.Z,{alt:e,color:i,elementTiming:n,fit:u,naturalHeight:a,naturalWidth:d,onLoad:c,src:h,children:t})}},570529:(e,t,i)=>{i.d(t,{T:()=>o,g:()=>s});let{Provider:n,useHook:l}=(0,i(471314).Z)({name:"story_pin_step",sampleRate:1}),o=n,s=l},766742:(e,t,i)=>{i.d(t,{BN:()=>c,RK:()=>d,d3:()=>u,tq:()=>p,xm:()=>h});var n=i(667294),l=i(911344),o=i(749886),s=i(685247),r=i(494125);let a=(e,t)=>{let i=(0,o.pE)(e,t);return`${i.y}px ${i.x}px`},d=({alignment:e,verticalAlignment:t})=>{let i={alignItems:"flex-start",display:"flex",height:"100%",justifyContent:"start",textAlign:"left",width:"100%"};return 1===t?i.alignItems="center":2===t&&(i.alignItems="flex-end"),1===e&&(i.justifyContent="center",i.textAlign="center"),i},c=({fontSize:e,hexColor:t,highlightColor:i,letterSpacing:n,lineHeight:l,name:o})=>({fontSize:e,letterSpacing:n,color:t,fontFamily:o,margin:0,maxHeight:"100%",textShadow:!i&&t&&"#ffffff"===t.toLowerCase()?"0px 1px 4px rgba(0, 0, 0, 0.2)":void 0,wordBreak:"break-word",...i?{backgroundColor:i,borderRadius:e/5,padding:a(e,l)}:{}}),h=({fontSize:e,hasText:t,highlightColor:i,lineHeight:n})=>({...i?{backgroundColor:t?i:void 0,borderRadius:e/5,padding:a(e,n)}:{}}),u=({letterSpacing:e,lineHeight:t,name:i,url:n})=>({fontFamily:i,fontGroup:"",fontOverrides:{letterSpacing:e,lineHeight:t,textTransform:!1},format:"truetype",defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"normal",fontUrl:n}]}),p=({hasPin:e,pages:t,limitToSingleFont:i})=>{let[a,d]=(0,n.useState)(!1),[c,h]=(0,n.useState)(()=>!!e&&(0,s.X7)(t)),p=()=>{let e=t.reduce((e,t)=>{let n=t?.blocks?.filter(e=>[o.h8.PARAGRAPH,o.h8.HEADING].includes(e.type))||[];return i&&n.length>1&&(n=[n[0]]),n.forEach(t=>{let i=t.style?.font||o.Cc.font,{name:n=""}=i;e[n]||(e[n]=i)}),e},{});if(Object.keys(e).length>0){let t=Object.keys(e).map(t=>{let i=e[t];return u({letterSpacing:i.letter_spacing,lineHeight:i.line_height,name:i.name,url:i.url})});(0,l.Z)(t),d(!0)}};return(0,r.Z)(()=>{p()}),(0,r.Z)(()=>{c||p()}),(0,n.useEffect)(()=>{c||h((0,s.X7)(t))},[c,t]),{fontsLoaded:a,mediaDataReceived:c}}},520718:(e,t,i)=>{i.d(t,{Z:()=>n});function n({currentTime:e,endTime:t,startTime:i}){return"number"!=typeof i||"number"!=typeof t||!(i>=0)||!(t>0)||!(i<t)||i<=e&&e<=t}},685247:(e,t,i)=>{i.d(t,{B7:()=>s,X7:()=>r,n4:()=>o});var n=i(749886);function l(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let o=(e,t)=>{let i=/^\d{1,3}\.\d{1,3}(?:\.\d{1,6})?$/;if(!e?.match(i)||!t?.match(i))return null;let n=e?.split("."),l=t?.split("."),o=Math.max((n??"").length,(l??"").length);for(let e=0;e<o;e+=1){let t=e<(n?.length??0)?parseInt(n?.[e],10):0,i=e<(l?.length??0)?parseInt(l?.[e],10):0;if(t<i)return -1;if(t>i)return 1}return 0};class s{constructor(e,t,i){if(l(this,"start",Date.now()),l(this,"paused",!1),this.onProgress=e,this.onComplete=t,this.duration=i,this.remaining=i,"undefined"==typeof window)return;this.intervalId=window.setInterval(()=>{let e=this.paused?this.duration-this.remaining:this.duration-this.remaining+(Date.now()-this.start);this.onProgress(e/this.duration)},500),this.resume()}currentTime(){return this.duration-this.remaining}pause(){this.paused=!0,window.clearTimeout(this.timerId),this.remaining-=Date.now()-this.start;let e=this.duration-this.remaining;this.onProgress(e/this.duration)}resume(){this.paused=!1,this.start=Date.now(),window.clearTimeout(this.timerId),this.timerId=window.setTimeout(this.onComplete,this.remaining)}clear(){window.clearTimeout(this.timerId),window.clearInterval(this.intervalId)}}let r=e=>e.some(e=>(e?.blocks??[]).some(e=>e.type===n.h8.IMAGE&&!!e.image||e.type===n.h8.VIDEO&&(!!e.video||!!e.video_signature)))},973868:(e,t,i)=>{i.d(t,{Z:()=>_});var n=i(667294),l=i(883119),o=i(515278),s=i(930837),r=i(140017),a=i(340523),d=i(923368),c=i(898233),h=i(785893);let u=new l.Ry(3);function p({anchor:e,children:t,displayOptions:i,onFlyoutDismiss:n}){let o=(0,r.ZP)(),{stackedCloseupEnabled:c}=(0,d.x4)(),{checkExperiment:p}=(0,a.F)(),_=p("sg_dweb_sharesheet_update").anyEnabled?s.b7:void 0;return i?.shownWithinMasonry||i?.shownWithinProfileHeader?(0,h.jsx)(l.mh,{zIndex:i.shownWithinProfileHeader||c&&i?.shownWithinMasonry?u:_,children:(0,h.jsx)(l.xu,{position:i.inModal?"absolute":void 0,top:!!i.inModal||void 0,zIndex:i.inModal?s.b7:void 0,children:(0,h.jsx)(l.J2,{_deprecatedShowCaret:i.showCaret,accessibilityLabel:o._('Share Menu', 'SendShareController.ShareMenu.accessibilityLabel', 'Accessbililty label for the share menu.'),anchor:e,idealDirection:i.idealDirection??"down",onDismiss:()=>{n()},positionRelativeToAnchor:!1,size:"flexible",children:t})})}):(0,h.jsx)(l.J2,{_deprecatedShowCaret:i?.showCaret,accessibilityLabel:o._('Share Menu', 'SendShareController.ShareMenu.accessibilityLabel', 'Accessbililty label for the share menu.'),anchor:e,idealDirection:i?.idealDirection??"down",onDismiss:()=>{n()},size:"flexible",children:t})}function _({children:e,flyoutDisplayOptions:t,isFlyoutOpen:i,loggingOptions:s,onClick:r,onFlyoutDismiss:a,onToggleFlyout:d,sendObject:u}){let _=(0,n.useRef)(null),g=(0,o.Z)();return(0,h.jsxs)(l.xu,{ref:_,dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},children:[(0,h.jsx)(l.xu,{children:e({handleSendShareFlyoutButtonClick:()=>{if(g){g();return}d()}})}),i&&(0,h.jsx)(p,{anchor:_.current,displayOptions:t,onFlyoutDismiss:a,children:(0,h.jsx)(c.Z,{component:s.component,element:s.element,onExternalSend:s.onExternalSend,onHide:()=>{r?.(),a()},sendType:u.type,sharedObject:{...u,type:"user"===u.type?"pinner":u.type},viewParameter:s.viewParameter,viewType:s.viewType})})]})}},667665:(e,t,i)=>{let n;i.d(t,{GL:()=>s,_z:()=>l,d0:()=>a,hO:()=>r,pM:()=>o});let l="video",o="image",s=new Map([["DEFAULT",new Set(["button"])],["story_pin",new Set([l])],["product_detail_page",new Set(["description","shopButton","thumbnailsLoaded"])],["product_detail_page_plus",new Set(["description","shopButton","thumbnailsLoaded"])]]),r=(n=new Set,s.forEach(e=>{n=new Set([...n,...e])}),n),a=new Set([...r,o,"resource"])},771981:(e,t,i)=>{i.d(t,{Ai:()=>w,B5:()=>_,CR:()=>h,Cc:()=>r,HG:()=>f,R_:()=>d,Wz:()=>a,_P:()=>x,dP:()=>S,dX:()=>b,gx:()=>u,h8:()=>o,hk:()=>c,lp:()=>m,lt:()=>p,oe:()=>v,r4:()=>y,rM:()=>P});var n=i(883119),l=i(737684);let o={GENERIC_STICKER:"story_pin_generic_interactive_sticker_block",HEADING:"story_pin_heading_block",IMAGE:"story_pin_image_block",INGREDIENT:"story_pin_ingredient_block",LINK:"story_pin_link_block",MENTION_STICKER:"story_pin_mention_sticker_block",MUSIC:"story_pin_music_block",PARAGRAPH:"story_pin_paragraph_block",PRODUCT_STICKER:"story_pin_product_sticker_block",SUPPLY:"story_pin_supply_block",VIDEO:"story_pin_video_block",VTO_MAKEUP_STICKER:"story_pin_virtual_try_on_makeup_sticker_block"},s={alignment:1,hex_color:"#111111",highlight_color:"#FFFFFF",vertical_alignment:1},r={...s,font:{default_size:28,letter_spacing:-.4,line_height:1.25,name:"Graphik Regular",url:"https://pinterest-taipei.s3.amazonaws.com/Graphik-Regular.otf"},font_size:28},a={...s,font:{default_size:48,letter_spacing:0,line_height:1,name:"Graphik Bold Italic",url:"https://pinterest-taipei.s3.amazonaws.com/Graphik-Bold-Italic.otf"},font_size:48},d=64,c=64,h=48,u=48,p=new n.H3([l.tD]),_=new n.H3([p]),g=new n.H3([l.tD]),m=new n.H3([g]),y=4;function x(e){return e?{paddingX:0,paddingY:0}:{paddingX:2,paddingY:y}}let f=6,v=47,b=8,P=4,w=5,S=3},851193:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(837639);function l(e){return{defaultStyle:0,fontFamily:e.name??"",fontGroup:n.gu,fontOverrides:{letterSpacing:e.letter_spacing,lineHeight:e.line_height},format:"truetype",id:e.id,styles:[{fontStyle:"",fontUrl:e.url,fontWeight:"normal",name:"normal"}]}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/90328-b2b3c8504931c33a.mjs.map